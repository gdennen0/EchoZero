# FaderSubTrack Object Reference Documentation
# Source: grandMA3 Dump() command on FaderSubTrack object
# Command: DataPool().Timecodes[101][1][11][1]:Dump()
# Date: [When this was captured]

## Overview

A FaderSubTrack contains fader events (FaderEvents) that control fader values at specific times. It is a child of TimeRange, similar to CmdSubTrack but for fader control.

**Hierarchy:** `DataPool().Timecodes[timecode_no][track_group_no][track_no][time_range_no][fader_subtrack_no]`

## Object Information

**Name:** FaderSubTrack 1
**Class:** FaderSubTrack
**Path:** Root/ShowData/DataPools/1 'Default'/Timecodes/101 'Intro_Feel'/1 'Test'/5105 'BEAM'/TimeRange 1/FaderSubTrack 1

---

## Access Methods

### Basic Access

```lua
-- Access FaderSubTrack through hierarchy
local tc = DataPool().Timecodes[101]
local tg = tc[1]
local tracks = tg:Children()
local track = tracks[2]  -- Skip Marker at index 0
local time_ranges = track:Children()
local tr = time_ranges[1]
local sub_tracks = tr:Children()

-- Find FaderSubTrack (may be at different index than CmdSubTrack)
local fst = nil
for i = 1, #sub_tracks do
    local subtrack = sub_tracks[i]
    local class = subtrack:GetClass()
    if class == "FaderSubTrack" then
        fst = subtrack
        break
    end
end
```

### Helper Function

```lua
function GetFaderSubTrack(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    local tc = DataPool().Timecodes[tc_no]
    if not tc then return nil end
    
    local tg = tc[tg_idx]
    if not tg then return nil end
    
    local tracks = tg:Children()
    if not tracks[track_idx] then return nil end
    
    local track = tracks[track_idx]
    local time_ranges = track:Children()
    if not time_ranges[tr_idx] then return nil end
    
    local tr = time_ranges[tr_idx]
    local sub_tracks = tr:Children()
    if not sub_tracks[fst_idx] then return nil end
    
    local subtrack = sub_tracks[fst_idx]
    local class = subtrack:GetClass()
    
    if class == "FaderSubTrack" then
        return subtrack
    end
    
    return nil
end

-- Alternative: Find first FaderSubTrack
function FindFaderSubTrack(tc_no, tg_idx, track_idx, tr_idx)
    local tc = DataPool().Timecodes[tc_no]
    if not tc then return nil end
    
    local tg = tc[tg_idx]
    if not tg then return nil end
    
    local tracks = tg:Children()
    if not tracks[track_idx] then return nil end
    
    local track = tracks[track_idx]
    local time_ranges = track:Children()
    if not time_ranges[tr_idx] then return nil end
    
    local tr = time_ranges[tr_idx]
    local sub_tracks = tr:Children()
    
    for i = 1, #sub_tracks do
        local subtrack = sub_tracks[i]
        local class = subtrack:GetClass()
        if class == "FaderSubTrack" then
            return subtrack, i
        end
    end
    
    return nil
end
```

---

## Properties

### Standard Properties

| Property | Type | Read Only | Description |
|----------|------|-----------|-------------|
| NAME | "FaderSubTrack 1" | No | FaderSubTrack name |
| INDEX | "1" | Yes | Array index |
| COUNT | "3" | Yes | Number of FaderEvents |
| NO | "1 (3)" | Yes | Number representation |
| MEMORYFOOTPRINT | "1.2 KB" | Yes | Memory usage |
| NOTE | "" | No | Notes |
| HIDDEN | "No" | No | Visibility state |
| LOCK | "" | No | Lock status |

### FaderSubTrack-Specific Properties

| Property | Type | Read Only | Description |
|----------|------|-----------|-------------|
| FADERTOKEN | "Master" | No | Fader token reference |

### Accessing Properties

```lua
local fst = FindFaderSubTrack(101, 1, 2, 1)

-- Access via property name (direct)
local name = fst.name
local count = fst.count
local fadertoken = fst.fadertoken

-- Access via :Get() method
local name = fst:Get("NAME")
local count = fst:Get("COUNT")
local fadertoken = fst:Get("FADERTOKEN")

-- Setting properties
fst.name = "My FaderSubTrack"
fst.fadertoken = "Master"
fst.note = "My notes"
```

---

## Children (FaderEvents)

FaderSubTracks contain FaderEvents that control fader values at specific times.

### Accessing Children

```lua
local fst = FindFaderSubTrack(101, 1, 2, 1)

-- Get all FaderEvents
local events = fst:Children()

-- Access specific FaderEvent
local event = events[1]  -- First FaderEvent

-- Iterate FaderEvents
for i = 1, #events do
    local event = events[i]
    Printf("Event " .. i .. ": " .. event.name)
end
```

See `FaderEvent/FaderEvent.txt` for FaderEvent documentation.

---

## Common Operations

### Listing All FaderEvents

```lua
function ListFaderEvents(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    local fst = GetFaderSubTrack(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    if not fst then
        Printf("FaderSubTrack not found")
        return
    end
    
    Printf("FaderSubTrack: " .. fst.name)
    Printf("Fader Token: " .. fst.fadertoken)
    
    local events = fst:Children()
    Printf("FaderEvents: " .. #events)
    Printf("")
    
    for i = 1, #events do
        local event = events[i]
        local time = event.time or "?"
        local fadervalue = event.fadervalue or "?"
        Printf(string.format("  Event [%d]: %s (Time: %s, Value: %s)", 
              i, event.name, time, fadervalue))
    end
end
```

### Getting FaderEvent by Index

```lua
function GetFaderEvent(tc_no, tg_idx, track_idx, tr_idx, fst_idx, event_idx)
    local fst = GetFaderSubTrack(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    if not fst then return nil end
    
    local events = fst:Children()
    if not events[event_idx] then return nil end
    
    return events[event_idx]
end
```

### Getting FaderEvent by Time

```lua
function GetFaderEventByTime(tc_no, tg_idx, track_idx, tr_idx, fst_idx, target_time)
    local fst = GetFaderSubTrack(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    if not fst then return nil end
    
    local events = fst:Children()
    
    for i = 1, #events do
        local event = events[i]
        local time = tonumber(event.time) or 0
        
        if time == target_time then
            return event, i
        end
    end
    
    return nil
end
```

### Dumping FaderSubTrack

```lua
-- Dump entire FaderSubTrack object
local fst = FindFaderSubTrack(101, 1, 2, 1)
fst:Dump()

-- Or via command line
-- Lua "DataPool().Timecodes[101][1][11][1]:Dump()"
```

---

## Examples

### Example 1: Access FaderSubTrack and List Events

```lua
local fst = FindFaderSubTrack(101, 1, 2, 1)
if fst then
    Printf("FaderSubTrack: " .. fst.name)
    Printf("Fader Token: " .. fst.fadertoken)
    Printf("Event count: " .. fst.count)
    
    local events = fst:Children()
    for i = 1, #events do
        local event = events[i]
        Printf("  Event " .. i .. ": " .. event.name .. " at " .. event.time .. " = " .. event.fadervalue)
    end
end
```

### Example 2: Find Events by Fader Token

```lua
function FindFaderEventsByToken(tc_no, tg_idx, track_idx, tr_idx, fst_idx, token)
    local fst = GetFaderSubTrack(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    if not fst then return {} end
    
    local events = fst:Children()
    local found = {}
    
    for i = 1, #events do
        local event = events[i]
        if event.token == token then
            table.insert(found, {event = event, index = i})
        end
    end
    
    return found
end

-- Usage: Find all "FaderMaster" events
local master_events = FindFaderEventsByToken(101, 1, 2, 1, 1, "FaderMaster")
Printf("Found " .. #master_events .. " FaderMaster events")
```

### Example 3: Get FaderSubTrack Statistics

```lua
function GetFaderSubTrackStats(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    local fst = GetFaderSubTrack(tc_no, tg_idx, track_idx, tr_idx, fst_idx)
    if not fst then return nil end
    
    local events = fst:Children()
    
    local stats = {
        name = fst.name,
        fadertoken = fst.fadertoken,
        total_events = #events,
        time_range = {min = nil, max = nil},
        value_range = {min = nil, max = nil}
    }
    
    for i = 1, #events do
        local event = events[i]
        
        -- Track time range
        local time = tonumber(event.time) or 0
        if not stats.time_range.min or time < stats.time_range.min then
            stats.time_range.min = time
        end
        if not stats.time_range.max or time > stats.time_range.max then
            stats.time_range.max = time
        end
        
        -- Track value range
        local value = tonumber(event.fadervalue) or 0
        if not stats.value_range.min or value < stats.value_range.min then
            stats.value_range.min = value
        end
        if not stats.value_range.max or value > stats.value_range.max then
            stats.value_range.max = value
        end
    end
    
    return stats
end
```

---

## Related Documentation

- See `../TimeRange.txt` for TimeRange documentation
- See `FaderEvent/FaderEvent.txt` for FaderEvent documentation
- See `../../CmdSubTrack/CmdSubTrack.txt` for CmdSubTrack documentation (similar structure)
- See `TIMECODE_STRUCTURE.md` for overall timecode hierarchy
